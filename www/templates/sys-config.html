<!--
/*
 * SPDX-License-Identifier: GPL-3.0-or-later
 * Copyright 2014 The moOde audio player project / Tim Curtis
*/
-->
<div id="container">
<div class="container">
	<h1 class="sys-config">System</h1>

	<form class="form-horizontal" method="post" enctype="multipart/form-data">
		<div class="control-group">
			<legend>Software update</legend>
			<p class="sub-legend">
				This release is: $_this_mooderel
			</p>
			<label class="control-label">Notification</label>
			<div class="controls">
				<div class="toggle">
					<label class="toggle-radio toggle-updater-auto-check" for="toggle-updater-auto-check-2">ON</label>$_select[updater_auto_check_on]
					<label class="toggle-radio toggle-updater-auto-check" for="toggle-updater-auto-check-1">OFF</label>$_select[updater_auto_check_off]
				</div>
				<button id="btn-set-updater-auto-check" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_updater_auto_check" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-update-updater-auto-check" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span id="info-update-updater-auto-check" class="config-help-info">
					Display a notification badge in Playback view if an available software update was detected during startup.
				</span>
			</div>

			<label class="control-label">Available</label>
			<div class="controls">
				<button class="btn btn-medium btn-primary config-btn btn-submit" type="submit" name="checkfor_update" value="novalue">Check</button>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-checkfor-update" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				$_available_upd
				<span id="info-checkfor-update" class="config-help-info">
					Check for an available software update.
				</span>
		    </div>

			<label class="control-label">Status</label>
			<div class="controls">
				<a href="sys-status.php"><button class="btn btn-medium btn-primary config-btn">View</button></a>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-view-status" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span id="info-view-status" class="config-help-info">
					View progress of the active in-place update or if the update has previously been applied view the update log.
				</span>
		    </div>
		</div>

		<div class="control-group">
			<legend>General</legend>
			<label class="control-label" for="hostname">Host/player name</label>
            <div class="controls">
                <input class="config-input-large" type="text" pattern="[A-Za-z0-9\-]{3,63}" id="hostname" name="hostname" value="$_select[hostname]" required>
				<button class="btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_host_name" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<span class="config-help-info">
					Length 3-63 characters, alphanumeric and hyphen allowed. This is the name that will appear on the network.
				</span>
            </div>

            <label class="control-label" for="browsertitle">Browser title</label>
            <div class="controls">
                <input class="config-input-large" type="text" id="browsertitle" name="browsertitle" value="$_select[browsertitle]" required>
				<button class="btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_browser_title" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
            </div>

			<label class="control-label" for="timezone">Timezone</label>
			<div class="controls">
				<select id="timezone" class="config-select-large" name="timezone" onchange="autoClick('#btn-set-timezone');">
					$_timezone[timezone]
				</select>
				<button id="btn-set-timezone" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_time_zone" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
			</div>

            <label class="control-label" for="keyboard">Keyboard layout</label>
            <div class="controls">
                <select id="keyboard" class="config-select-large" name="keyboard" onchange="autoClick('#btn-set-keyboard');">
                    $_keyboard[keyboard]
                </select>
                <button id="btn-set-keyboard" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_keyboard" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
            </div>
		</div>

		<div class="control-group">
			<legend>Startup options</legend>
			<label class="control-label" for="worker-responsiveness">Worker response</label>
			<div class="controls">
				<select id="worker-responsiveness" class="config-select-large" name="worker_responsiveness" onchange="autoClick('#btn-set-worker-responsiveness');">
					$_select[worker_responsiveness]
				</select>
				<button id="btn-set-worker-responsiveness" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_worker_responsiveness" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-worker-responsiveness" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span id="info-worker-responsiveness" class="config-help-info">
					<b>Default:</b> For all Raspberry Pi models.<br>
					<b>Boosted:</b> Experimental for multi-core Raspberry Pi's. This provides more responsiveness when using the Configuration screens or making other setting changes that require processing by the Worker daemon.
				</span>
			</div>

			<label class="control-label" for="cpugov">CPU governor</label>
			<div class="controls">
				<select id="cpugov" class="config-select-large" name="cpugov" onchange="autoClick('#btn-set-cpugov');">
					$_select[cpugov]
				</select>
				<button id="btn-set-cpugov" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_cpugov" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-cpugov" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span id="info-cpugov" class="config-help-info">
					<b>On-demand:</b> Scale CPU frequency from min to max based on load.<br>
					<b>Performance:</b> Run the CPU at max frequency.
				</span>
			</div>

			<div class="$_pi_audio_driver_hide">
				<label class="control-label" for="pi-audio-driver">Integrated audio</label>
				<div class="controls">
					<select id="pi-audio-driver" class="config-select-large" name="pi_audio_driver" onchange="autoClick('#btn-set-pi-audio-driver');">
						$_select[pi_audio_driver]
					</select>
					<button id="btn-set-pi-audio-driver" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_pi_audio_driver" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
					<a aria-label="Help" class="config-info-toggle" data-cmd="info-pi-audio-driver" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
					<span id="info-pi-audio-driver" class="config-help-info">
						<b>Kernel mode:</b> Default vc4-kms-v3d driver for advanced Pi HDMI capabilities.<br>
						<b>Firmware mode:</b> Legacy snd-bcm2835 driver to support Pi Headphone only configuration. No other audio, video or system features are supported.
					</span>
				</div>
			</div>

			<div class="$_pci_express_hide">
				<label class="control-label" for="pci-express">PCI express</label>
				<div class="controls">
					<select id="pci-express" class="config-select-large" name="pci_express" onchange="autoClick('#btn-set-pci-express');">
						$_select[pci_express]
					</select>
					<button id="btn-set-pci-express" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_pci_express" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
					<a aria-label="Help" class="config-info-toggle" data-cmd="info-pci-express" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
					<span id="info-pci-express" class="config-help-info">
						<b>Auto:</b> Gen 2.0 is auto-set during boot if the PCIe connector has power, PCIE_PROBE=1, or NVME is in the boot order.<br>
						<b>Gen 2.0:</b> Pi 5 PCIe feature is certified for up to 5 GT/sec.<br>
						<b>Gen 3.0:</b> Force Gen 3.0 speeds up to 10 GT/sec. Warning Pi 5 is not certified for Gen 3.0 speeds and connections may be unstable.
					</span>
				</div>
			</div>

			<div class="config-horiz-rule"></div>

			<div class="$_reduce_power_hide">
				<label class="control-label">Reduce power</label>
				<div class="controls">
					<div class="toggle">
						<label class="toggle-radio toggle-reduce-power" for="toggle-reduce-power-2">ON </label>$_select[reduce_power_on]
						<label class="toggle-radio toggle-reduce-power" for="toggle-reduce-power-1">OFF</label>$_select[reduce_power_off]
					</div>
					<button id="btn-set-reduce-power" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_reduce_power" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
					<a aria-label="Help" class="config-info-toggle" data-cmd="info-reduce-power" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
					<span id="info-reduce-power" class="config-help-info">
						Turn this option on to reduce shutdown wattage to 0.01W.
						The default shutdown wattage is around 1 to 1.4W to support some HAT'S that require both the 3V and 5V rails.
                    </span>
				</div>
			</div>

			<div class="$_fan_temp0_hide">
				<label class="control-label" for="fan-temp0">Fan control</label>
	            <div class="controls">
	                <input class="config-input-large" type="text" id="fan-temp0" name="fan_temp0" value="$_select[fan_temp0]">
					<button class="btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_fan_temp0" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
					<a aria-label="Help" class="config-info-toggle" data-cmd="info-fan-temp0" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
					<span class="config-help-static">
						Format is: Threshold 45-55C, Target 40-50C, Speed 75-125.<br>
						Default: 50,45,75.
                    </span>
					<span id="info-fan-temp0" class="config-help-info">
						Adjust fan_temp0 settings. Default temperature map is below.<br>
						- fan_temp0=50000,fan_temp0_hyst=5000,fan_temp0_speed=75<br>
					    - fan_temp1=60000,fan_temp1_hyst=5000,fan_temp1_speed=125<br>
					    - fan_temp2=67500,fan_temp2_hyst=5000,fan_temp2_speed=175<br>
					    - fan_temp3=75000,fan_temp3_hyst=5000,fan_temp3_speed=250<br>
                    </span>
	            </div>
			</div>

			<div class="$_wifibt_hide">
				<label class="control-label">WiFi</label>
				<div class="controls">
					<div class="toggle">
						<label class="toggle-radio toggle-p3wifi" for="toggle-p3wifi-2">ON </label>$_select[p3wifi_on]
						<label class="toggle-radio toggle-p3wifi" for="toggle-p3wifi-1">OFF</label>$_select[p3wifi_off]
					</div>
					<button id="btn-set-p3wifi" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_p3wifi" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
					<a aria-label="Help" class="config-info-toggle" data-cmd="info-p3wifi" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
					<span id="info-p3wifi" class="config-help-info">
						The integrated adapter appears on Pi-Zero W and Pi-3B and higher and models.
                    </span>
				</div>

				<label class="control-label">Bluetooth</label>
				<div class="controls">
					<div class="toggle">
						<label class="toggle-radio toggle-p3bt" for="toggle-p3bt-2">ON </label>$_select[p3bt_on]
						<label class="toggle-radio toggle-p3bt" for="toggle-p3bt-1">OFF</label>$_select[p3bt_off]
					</div>
					<button id="btn-set-p3bt" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_p3bt" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
					<a aria-label="Help" class="config-info-toggle" data-cmd="info-p3bt" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
					<span id="info-p3bt" class="config-help-info">
						The integrated adapter appears on Pi-Zero W and Pi-3B and higher and models.
                    </span>
				</div>
			</div>

			<label class="control-label">LED0 (Activity)</label>
			<div class="controls">
				<div class="toggle">
					<label class="toggle-radio toggle-actled" for="toggle-actled-2">ON </label>$_select[actled_on]
					<label class="toggle-radio toggle-actled" for="toggle-actled-1">OFF</label>$_select[actled_off]
				</div>
				<button id="btn-set-actled" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_actled" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-actled" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span id="info-actled" class="config-help-info">
					Turn the activity LED flashing for SDCard (mmc0) on/off.
                </span>
			</div>

			<div class="$_pwrled_hide">
				<label class="control-label">LED1 (Power)</label>
				<div class="controls">
					<div class="toggle">
						<label class="toggle-radio toggle-pwrled" for="toggle-pwrled-2">ON </label>$_select[pwrled_on]
						<label class="toggle-radio toggle-pwrled" for="toggle-pwrled-1">OFF</label>$_select[pwrled_off]
					</div>
					<button id="btn-set-pwrled" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_pwrled" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
					<a aria-label="Help" class="config-info-toggle" data-cmd="info-pwrled" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
					<span id="info-pwrled" class="config-help-info">
						Turn the Power LED on/off.
                    </span>
				</div>
			</div>

			<div class="config-horiz-rule"></div>

			<label class="control-label" for="ipaddr-timeout">Address timeout</label>
			<div class="controls">
				<select id="ipaddr-timeout" class="config-select-large" name="ipaddr_timeout" onchange="autoClick('#btn-set-ipaddr-timeout');">
					$_select[ipaddr_timeout]
				</select>
				<button id="btn-set-ipaddr-timeout" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_ipaddr_timeout" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<span class="config-help-static">
					Wait up to the specified time period for an IP address to be assigned to an adapter during startup.
				    If no adapter has received an IP address the WiFi Hotspot will be started to ensure that moOde can be accessed.
				</span>
			</div>

			<label class="control-label">Wait for Ethernet</label>
			<div class="controls">
				<div class="toggle">
					<label class="toggle-radio toggle-eth0chk" for="toggle-eth0chk-2">ON </label>$_select[eth0chk_on]
					<label class="toggle-radio toggle-eth0chk" for="toggle-eth0chk-1">OFF</label>$_select[eth0chk_off]
				</div>
				<button id="btn-set-eth0chk" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_eth0chk" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-eth0chk" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span id="info-eth0chk" class="config-help-info">
					Wait for up to "Address timeout" seconds for an address to be assigned to the Ethernet adapter.
					If set to NO the address check will be skipped and startup time will be reduced.
				</span>
			</div>
		</div>

		<div class="control-group">
			<legend>File sharing</legend>
			<p class="sub-legend">
				These services enable files that reside on this host to be accessible over the network by other hosts.
			</p>

			<label class="control-label">SMB (Samba)</label>
			<div class="controls">
				<div class="toggle">
					<label class="toggle-radio toggle-fs-smb" for="toggle-fs-smb-2">ON </label>$_select[fs_smb_on]
					<label class="toggle-radio toggle-fs-smb" for="toggle-fs-smb-1">OFF</label>$_select[fs_smb_off]
				</div>
				<button id="btn-set-fs-smb" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_fs_smb" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<span class="config-help-static">
					Server Message Block (SMB) allows files to be shared over a network with Windows, Mac and Linux clients.<br>
					<b>Shares:</b> NAS, NVMe, SATA, SDCard, Playlists and USB drives (by label).
				</span>
			</div>

			<label class="control-label" for="fs-smb-pwd">Password</label>
			<div class="controls">
				<input class="config-input-large" type="password" pattern=".{8,64}" id="fs-smb-pwd" name="fs_smb_pwd" value="$_select[fs_smb_pwd]" placeholder="None">
				<button class="btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_fs_smb_pwd" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<a class="show-hide-password $_show_hide_password_icon_hide" href="#notarget" data-id="fs-smb-pwd"><i class="fa-regular fa-sharp fa-eye" style="margin-left:0;"></i></a>
				<span class="config-help-static">
					Length: 8-63 characters.<br>
					If password is None specify anonymous access or userid "guest" and no password when mounting shares.<br>
					If a password is set specify the userid created in the Raspberry Pi Imager and this password when mounting shares.<br>
                	<b>Warning:</b> To avoid creating a security vulnerability, make sure this password is different from the one entered for the userid created in the Raspberry Pi Imager.
                </span>
			</div>

			<div class="config-horiz-rule"></div>

			<label class="control-label">NFS</label>
			<div class="controls">
				<div class="toggle">
					<label class="toggle-radio toggle-fs-nfs" for="toggle-fs-nfs-2">ON </label>$_select[fs_nfs_on]
					<label class="toggle-radio toggle-fs-nfs" for="toggle-fs-nfs-1">OFF</label>$_select[fs_nfs_off]
				</div>
				<button id="btn-set-fs-nfs" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_fs_nfs" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<span class="config-help-static">
					Network File Sharing (NFS) allows files to be shared over a network with Linux clients.<br>
					<b>Exports:</b> USB, NVMe, and SATA drive mounts are automatically maintained in /etc/exports. Other storage locations must be manualy added.<br>
					<b>Formats:</b> Only Ext4 and Fat32 (VFAT) file system formats are recommended for USB drives and only EXT4 is supported for NVMe drives.
				</span>
			</div>

			<label class="control-label" for="fs-nfs-access">Access</label>
			<div class="controls">
				<input id="fs-nfs-access" class="input-large config-input-large" type="text" name="fs_nfs_access" value="$_select[fs_nfs_access]" placeholder="IP address or subnet">
				<button class="btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_fs_nfs_access" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<span class="config-help-static">
					Specify a client IP or subnet address that is allowed access to NFS exports.<br>
					Use Classless Inter-Domain Routing (CIDR) notation for example /24 for 255.255.255.0 subnet, /32 for IP address.<br>
					This subnet is: <b>$_this_subnet</b>
				</span>
			</div>

			<label class="control-label" for="fs-nfs-options">Options</label>
			<div class="controls">
				<input id="fs-nfs-options" class="input-large config-input-large" type="text" name="fs_nfs_options" value="$_select[fs_nfs_options]" required>
				<button class="btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_fs_nfs_options" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<span class="config-help-static">
					These options determine the permissions granted to connected clients.<br>
					Default options: rw,sync,no_subtree_check,no_root_squash
				</span>
			</div>

			<div class="config-horiz-rule"></div>

			<div class="$_feat_minidlna">
				<label class="control-label">DLNA</label>
				<div class="controls">
					<div class="toggle">
						<label class="toggle-radio toggle-dlnasvc" for="toggle-dlnasvc-2">ON </label>$_select[dlnasvc_on]
						<label class="toggle-radio toggle-dlnasvc" for="toggle-dlnasvc-1">OFF</label>$_select[dlnasvc_off]
					</div>
					<button id="btn-set-dlnasvc" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_dlna_settings" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
					<span class="config-help-static">
						The DLNA media server indexes music sources defined for MPD and makes them available to UPnP control points.
	                </span>
				</div>

				<label class="control-label" for="dlnaname">Name</label>
				<div class="controls">
					<input class="config-input-large" type="text" id="dlnaname" name="dlnaname" value="$_select[dlnaname]" required>
					<button class="btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_dlna_settings" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				</div>

				<div class="controls">
					<a data-toggle="modal" href="#rebuild-dlnadb" $_dlna_link_disable><button class="btn btn-medium btn-primary config-btn" $_dlna_btn_disable>Rebuild</button>
					<span class="config-btn-after">DLNA database</span>
				</div>

				<div class="controls">
					<a href="http://$_select[hostip]:8200" class="btn btn-medium btn-primary config-btn target-blank-link" target="_blank" $_dlna_link_disable $_dlna_btn_disable>View</a>
					<span class="config-btn-after">Database status</span>
				</div>
			</div>
		</div>

		<div class="control-group">
			<legend>Security</legend>

			<!-- Shellinabox WebSSH -->
			<label class="control-label">Web SSH</label>
			<div class="controls">
				<div class="toggle">
					<label class="toggle-radio toggle-shellinabox" for="toggle-shellinabox-2">ON </label>$_select[shellinabox_on]
					<label class="toggle-radio toggle-shellinabox" for="toggle-shellinabox-1">OFF</label>$_select[shellinabox_off]
				</div>
				<button id="btn-set-shellinabox" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_shellinabox" value="novalue" $_webssh_set_disable><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<span class="config-help-static config-help-less-margin">
					Web based Secure Shell terminal using Shellinabox by Markus Gutschk and Luka Krajger.
                </span>
			</div>
			<div class="controls">
				<a href="http://$_select[hostip]:4200" class="btn btn-medium btn-primary config-btn target-blank-link" target="_blank" $_webssh_link_disable $_webssh_open_disable>Open</a>
				<span class="config-btn-after">SSH terminal</span>
			</div>

			<!-- XSS detection -->
			<label class="control-label">XSS detection</label>
			<div class="controls">
				<div class="toggle">
					<label class="toggle-radio toggle-xss-detect" for="toggle-xss-detect-2">ON </label>$_select[xss_detect_on]
					<label class="toggle-radio toggle-xss-detect" for="toggle-xss-detect-1">OFF</label>$_select[xss_detect_off]
				</div>
				<button id="btn-set-xss-detect" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_xss_detect" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-xss-detect" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span class="config-help-static">
					Detect and report in the moOde log any embedded Cross-site Scripting (XSS) commands or characters found in music file metadata.
				</span>
				<span id="info-xss-detect" class="config-help-info">
					Detection is performed each time the Library tag cache is generated so only use this when needed.<br>
					- Clear the Library tag cache.<br>
					- Switch to Playback or Library view to regenerate it.<br>
					- View the moOde startup log for a list of suspect files/tags.<br>
					- Examine the tag value to determine whether its malicious XSS code or just text using < > or =.
				</span>
			</div>

			<div class="config-horiz-rule"></div>

			<!-- HTTPS mode -->
			<div class="$_feat_https">
				<label class="control-label">HTTPS mode</label>
				<div class="controls">
					<div class="toggle">
						<label class="toggle-radio toggle-nginx-https-only" for="toggle-nginx-https-only-2">ON </label>$_select[nginx_https_only_on]
						<label class="toggle-radio toggle-nginx-https-only" for="toggle-nginx-https-only-1">OFF</label>$_select[nginx_https_only_off]
					</div>
					<button id="btn-set-nginx-https-only" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_nginx_https_only" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
					<span class="config-help-static">
						<b>Experimental:</b> Enable secure communication between the Browser and moOde.<br>
						View the <a href="./setup_https.txt" class="target-blank-link" target="_blank">Configuration Guide</a>
						for information on how HTTPS mode works.
	                </span>
				</div>

				<label class="control-label" for="nginx-cert-type">Certificate type</label>
				<div class="controls">
					<select id="nginx-cert-type" class="config-select-large" name="nginx_cert_type" onchange="autoClick('#btn-set-nginx-cert-type');">
						$_select[nginx_cert_type]
					</select>
					<button id="btn-set-nginx-cert-type" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_nginx_cert_type" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
					<span class="config-help-static">
						<b>Automatic:</b> Automatically generate and install a self-signed certificate into NGINX web server when HTTPS mode is turned on.<br>
					    <b>Manual:</b> Click the UPLOAD followed by the INSTALL button for this type of certificate.
					</span>
				</div>

				<!--SAVE:label class="control-label">HSTS policy</label>
				<div class="controls">
					<div class="toggle">
						<label class="toggle-radio toggle-nginx-hsts-policy" for="toggle-nginx-hsts-policy-2">ON </label>$_select[nginx_hsts_policy_on]
						<label class="toggle-radio toggle-nginx-hsts-policy" for="toggle-nginx-hsts-policy-1">OFF</label>$_select[nginx_hsts_policy_off]
					</div>
					<button id="btn-set-nginx-hsts-policy" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_nginx_hsts_policy" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
					<span class="config-help-static">
						<b>Caution:</b> Turning this on sets a Browser policy that forces HTTPS even after turning HTTPS mode OFF.
					</span>
				</div-->

				<div class="$_automatic_cert">
					<label class="control-label">Certificate</label>
					<div class="controls">
						<button id="btn-download-self-signed-cert" class="btn btn-medium btn-primary config-btn" type="submit" name="download_self_signed_cert" value="1">Download</button>
						<div class="config-help-static">
 							Download the self-signed certificate for manual import into the certificate store on your client. The specific method for importing a certificate varies depending on the client OS.
						</div>
					</div>
				</div>

				<div class="$_manual_cert">
					<label class="control-label">Certificate</label>
					<div class="controls">
						<label for="nginx-cert-files" id="choose-nginx-cert-files" class="btn btn-primary btn-medium config-btn">Upload</label>
						<input type="file" id="nginx-cert-files" accept=".crt, .key" multiple name="nginx_cert_files[]" style="display:none" onchange="$('#btn-upload-nginx-cert-files').click();">
						<button id="btn-upload-nginx-cert-files" class="btn btn-medium btn-primary btn-submit" type="submit" name="upload_nginx_cert_files" value="1" style="display:none"></button>
						<a aria-label="Help" class="config-info-toggle" data-cmd="info-nginx-cert-files" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
						<span id="info-nginx-cert-files" class="config-help-info">
							Choose and upload the certificate .crt and .key files for subsequent installation into NGINX web server.
						</span>
						<div class="config-help-static">
							$_uploaded_cert_files
						</div>
					</div>

					<div class="controls">
						<button class="btn btn-medium btn-primary btn-submit config-btn" type="submit" name="nginx_install_cert" value="1">Install Certificate</button>
						<span class="config-help-static">
							Install the previously uploaded .crt and .key files into NGINX web server.
						</span>
					</div>
				</div>
			</div>
		</div>

		<div class="control-group">
			<legend>Backup/Restore</legend>
			<label class="control-label">Backup system</label>
			<div class="controls">
				<a href="bkp-config.php?action=backup"><button class="btn btn-medium btn-primary config-btn">Backup</button></a>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-backup-system" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span id="info-backup-system" class="config-help-info">
					Backup configuration settings and preferences, radio stations, playlists and CamillaDSP configs.
                </span>
			</div>

			<label class="control-label">Restore system</label>
			<div class="controls">
				<a href="bkp-config.php?action=restore"><button class="btn btn-medium btn-primary config-btn">Restore</button></a>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-restore-system" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span id="info-restore-system" class="config-help-info">
					Restore configuration settings and preferences, radio stations, playlists and CamillaDSP configs.
                </span>
			</div>
		</div>

		<div class="control-group">
			<legend>Logs</legend>

			<label class="control-label">Log to RAM</label>
			<div class="controls">
				<div class="toggle">
					<label class="toggle-radio toggle-log2ram" for="toggle-log2ram-2">ON </label>$_select[log2ram_on]
					<label class="toggle-radio toggle-log2ram" for="toggle-log2ram-1">OFF</label>$_select[log2ram_off]
				</div>
				<button id="btn-set-log2ram" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_log2ram" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<span class="config-help-static">
					$_log2ram_stats<br>
					Write logs to memory. Logs are flushed to disk once per day at 23:55:00 or whenever the system is restarted or shutdown.
				</span>
			</div>

			<div class="config-horiz-rule"></div>

			<label class="control-label">Startup log</label>
			<div class="controls">
				<button class="btn btn-medium btn-primary config-btn" type="submit" name="download_logs" value="1">Download</button>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-download-logs" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span id="info-download-logs" class="config-help-info">
					Download the moOde startup log: /var/log/moode.log
                </span>
			</div>

			<label class="control-label">System logs</label>
			<div class="controls">
				<a href="#clear-syslogs" data-toggle="modal"><button class="btn btn-medium btn-primary config-btn">Clear</button></a>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-clear-syslogs" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span id="info-clear-syslogs" class="config-help-info">
					Clear various system log files. Note the logs are cleared periodically by the Maintenance task.
                </span>
			</div>

			<label class="control-label">Play history log</label>
			<div class="controls">
				<a href="#clear-playbackhist" data-toggle="modal"><button class="btn btn-medium btn-primary config-btn">Clear</button></a>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-clear-playhistory" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span id="info-clear-playhistory" class="config-help-info">
					Clear the playback history log. Perform this task periodically since the log grows over time.
                </span>
			</div>

			<div class="config-horiz-rule"></div>

			<label class="control-label">Debug logging</label>
			<div class="controls">
				<div class="toggle">
					<label class="toggle-radio toggle-debuglog" for="toggle-debuglog-2">ON </label>$_select[debuglog_on]
					<label class="toggle-radio toggle-debuglog" for="toggle-debuglog-1">OFF</label>$_select[debuglog_off]
				</div>
				<button id="btn-set-debuglog" class="hide btn btn-primary btn-small config-btn-set btn-submit" type="submit" name="update_debuglog" value="novalue"><i class="fa fa-solid fa-sharp fa-arrow-turn-down-left"></i></button>
				<a aria-label="Help" class="config-info-toggle" data-cmd="info-debuglog" href="#notarget"><i class="fa-regular fa-sharp fa-info-circle"></i></a>
				<span id="info-debuglog" class="config-help-info">
					<b>Log files:</b><br>
					<table class="cdsp-help-table">
						<tr><td>Startup and Jobs</td><td>/var/log/moode.log</td></tr>
						<tr><td>Mount monitor</td><td>/var/log/moode_mountmon.log</td></tr>
						<tr><td>System updater</td><td>/var/log/moode_autocfg.log</td></tr>
						<tr><td>Auto-config</td><td>/var/log/moode_update.log</td></tr>
						<tr><td>Spotify</td><td>/var/log/moode_librespot.log</td></tr>
						<tr><td>AirPlay</td><td>/var/log/moode_shairport-sync.log</td></tr>
						<tr><td>Squeezelite event</td><td>/var/log/moode_slpower.log</td></tr>
						<tr><td>Spotify event</td><td>/var/log/moode_spotevent.log</td></tr>
						<tr><td>AirPlay event</td><td>/var/log/moode_spsevent.log</td></tr>
						<tr><td>Play history</td><td>/var/log/moode_playhistory.log</td></tr>
						<tr><td>WebUI Javascript</td><td>Browser console</td></tr>
					</table>
                </span>
				<span class="config-help-static">
					<b>Caution:</b> Only turn this option on when troubleshooting an issue. It can create large log files and degrade performance.
				</span>
			</div>
		</div>
	</form>
</div>
</div>

<form class="form-horizontal" method="post">
	<div id="view-pkgcontent" class="modal hide" tabindex="-1" role="dialog" aria-labelledby="view-pkgcontent-label" aria-hidden="true">
		<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			<h3 id="view-pkgcontent-label">Package content</h3>
		</div>
		<div class="modal-body">
			$_pkg_description
			$_pkg_relnotes
		</div>
		<div class="modal-footer">
			<button class="btn singleton" data-dismiss="modal" aria-hidden="true">Close</button>
		</div>
	</div>
</form>

<form class="form-horizontal" method="post">
	<div id="clear-playbackhist" class="modal hide" tabindex="-1" role="dialog" aria-labelledby="clear-playbackhist-label" aria-hidden="true">
		<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			<h3>Clear playback history?</h3>
		</div>
		<div class="modal-body"></div>
		<div class="modal-footer">
			<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
			<button class="btn btn-primary btn-submit" type="submit" name="update_clear_playhistory" value="novalue">Yes</button>
		</div>
	</div>
</form>

<form class="form-horizontal" method="post">
	<div id="clear-syslogs" class="modal hide" tabindex="-1" role="dialog" aria-labelledby="clear-syslogs-label" aria-hidden="true">
		<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			<h3>Clear system logs?</h3>
		</div>
		<div class="modal-body"></div>
		<div class="modal-footer">
			<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
			<button class="btn btn-primary btn-submit" type="submit" name="update_clear_syslogs" value="novalue">Yes</button>
		</div>
	</div>
</form>
